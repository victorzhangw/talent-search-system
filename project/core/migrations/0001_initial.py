# Generated by Django 4.2.20 on 2025-07-12 01:36

import core.models
from django.conf import settings
import django.contrib.auth.validators
from django.db import migrations, models
import django.db.models.deletion
import django.utils.timezone
import uuid


class Migration(migrations.Migration):

    initial = True

    dependencies = [
        ('contenttypes', '0002_remove_content_type_name'),
        ('auth', '0012_alter_user_first_name_max_length'),
    ]

    operations = [
        migrations.CreateModel(
            name='User',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('password', models.CharField(max_length=128, verbose_name='password')),
                ('last_login', models.DateTimeField(blank=True, null=True, verbose_name='last login')),
                ('is_superuser', models.BooleanField(default=False, help_text='Designates that this user has all permissions without explicitly assigning them.', verbose_name='superuser status')),
                ('username', models.CharField(error_messages={'unique': 'A user with that username already exists.'}, help_text='Required. 150 characters or fewer. Letters, digits and @/./+/-/_ only.', max_length=150, unique=True, validators=[django.contrib.auth.validators.UnicodeUsernameValidator()], verbose_name='username')),
                ('first_name', models.CharField(blank=True, max_length=150, verbose_name='first name')),
                ('last_name', models.CharField(blank=True, max_length=150, verbose_name='last name')),
                ('email', models.EmailField(blank=True, max_length=254, verbose_name='email address')),
                ('is_staff', models.BooleanField(default=False, help_text='Designates whether the user can log into this admin site.', verbose_name='staff status')),
                ('is_active', models.BooleanField(default=True, help_text='Designates whether this user should be treated as active. Unselect this instead of deleting accounts.', verbose_name='active')),
                ('date_joined', models.DateTimeField(default=django.utils.timezone.now, verbose_name='date joined')),
                ('user_type', models.CharField(choices=[('individual', '個人用戶'), ('enterprise', '企業用戶'), ('admin', '管理員')], default='individual', max_length=20)),
                ('phone', models.CharField(blank=True, max_length=20, null=True, verbose_name='電話')),
                ('avatar', models.ImageField(blank=True, null=True, upload_to='avatars/', verbose_name='頭像')),
                ('is_email_verified', models.BooleanField(default=False, verbose_name='Email已驗證')),
                ('email_verification_token', models.UUIDField(db_index=True, default=uuid.uuid4, verbose_name='Email驗證令牌')),
                ('password_reset_token', models.UUIDField(db_index=True, default=uuid.uuid4, verbose_name='密碼重設令牌')),
                ('password_reset_token_created', models.DateTimeField(blank=True, null=True, verbose_name='密碼重設令牌建立時間')),
                ('created_at', models.DateTimeField(default=django.utils.timezone.now, verbose_name='建立時間')),
                ('updated_at', models.DateTimeField(auto_now=True, verbose_name='更新時間')),
                ('groups', models.ManyToManyField(blank=True, help_text='The groups this user belongs to.', related_name='custom_user_set', related_query_name='custom_user', to='auth.group', verbose_name='groups')),
                ('user_permissions', models.ManyToManyField(blank=True, help_text='Specific permissions for this user.', related_name='custom_user_set', related_query_name='custom_user', to='auth.permission', verbose_name='user permissions')),
            ],
            options={
                'verbose_name': 'user',
                'verbose_name_plural': 'users',
                'abstract': False,
            },
            managers=[
                ('objects', core.models.UserManager()),
            ],
        ),
        migrations.CreateModel(
            name='CrawlerConfig',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('name', models.CharField(default='PI 爬蟲配置', max_length=100, verbose_name='配置名稱')),
                ('base_url', models.URLField(default='https://pi.perception-group.com/', verbose_name='爬蟲基礎網址')),
                ('username', models.CharField(blank=True, max_length=100, verbose_name='登入帳號')),
                ('password', models.CharField(blank=True, max_length=100, verbose_name='登入密碼')),
                ('is_active', models.BooleanField(default=True, verbose_name='是否啟用')),
                ('created_at', models.DateTimeField(auto_now_add=True, verbose_name='建立時間')),
                ('updated_at', models.DateTimeField(auto_now=True, verbose_name='更新時間')),
            ],
            options={
                'verbose_name': '爬蟲配置',
                'verbose_name_plural': '爬蟲配置',
                'db_table': 'crawler_config',
            },
        ),
        migrations.CreateModel(
            name='PointPackage',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('name', models.CharField(max_length=100, verbose_name='套餐名稱')),
                ('description', models.TextField(blank=True, verbose_name='套餐描述')),
                ('points', models.IntegerField(verbose_name='點數數量')),
                ('price', models.DecimalField(decimal_places=2, max_digits=10, verbose_name='價格')),
                ('bonus_points', models.IntegerField(default=0, verbose_name='贈送點數')),
                ('is_active', models.BooleanField(default=True, verbose_name='是否啟用')),
                ('sort_order', models.IntegerField(default=0, verbose_name='排序')),
                ('created_at', models.DateTimeField(auto_now_add=True, verbose_name='建立時間')),
                ('updated_at', models.DateTimeField(auto_now=True, verbose_name='更新時間')),
            ],
            options={
                'verbose_name': '點數套餐',
                'verbose_name_plural': '點數套餐',
                'db_table': 'point_package',
                'ordering': ['sort_order', 'price'],
            },
        ),
        migrations.CreateModel(
            name='TestCategory',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('name', models.CharField(max_length=100, verbose_name='類別名稱')),
                ('description', models.TextField(blank=True, verbose_name='類別描述')),
                ('is_active', models.BooleanField(default=True, verbose_name='是否啟用')),
                ('created_at', models.DateTimeField(auto_now_add=True, verbose_name='建立時間')),
            ],
            options={
                'verbose_name': '測驗類別',
                'verbose_name_plural': '測驗類別',
                'db_table': 'test_category_old',
            },
        ),
        migrations.CreateModel(
            name='TestInvitation',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('invitation_code', models.UUIDField(default=uuid.uuid4, unique=True, verbose_name='邀請碼')),
                ('custom_message', models.TextField(blank=True, verbose_name='自訂邀請訊息')),
                ('invited_at', models.DateTimeField(auto_now_add=True, verbose_name='邀請時間')),
                ('expires_at', models.DateTimeField(verbose_name='過期時間')),
                ('started_at', models.DateTimeField(blank=True, null=True, verbose_name='開始時間')),
                ('completed_at', models.DateTimeField(blank=True, null=True, verbose_name='完成時間')),
                ('status', models.CharField(choices=[('pending', '待執行'), ('in_progress', '進行中'), ('completed', '已完成'), ('expired', '已過期'), ('cancelled', '已取消')], default='pending', max_length=20, verbose_name='狀態')),
                ('points_consumed', models.IntegerField(verbose_name='消費點數')),
                ('score', models.FloatField(blank=True, null=True, verbose_name='測驗分數')),
                ('result_data', models.JSONField(blank=True, default=dict, verbose_name='測驗結果資料')),
                ('enterprise', models.ForeignKey(limit_choices_to={'user_type': 'enterprise'}, on_delete=django.db.models.deletion.CASCADE, related_name='sent_invitations', to=settings.AUTH_USER_MODEL, verbose_name='邀請企業')),
            ],
            options={
                'verbose_name': '測驗邀請',
                'verbose_name_plural': '測驗邀請',
                'db_table': 'test_invitation',
                'ordering': ['-invited_at'],
            },
        ),
        migrations.CreateModel(
            name='TestProject',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('name', models.CharField(max_length=200, verbose_name='測驗名稱')),
                ('description', models.TextField(blank=True, verbose_name='測驗描述')),
                ('test_link', models.URLField(help_text='外部測驗網站的連結', verbose_name='測驗連結')),
                ('score_field_chinese', models.CharField(max_length=100, verbose_name='評分欄位中文名稱')),
                ('score_field_system', models.CharField(max_length=100, verbose_name='評分欄位系統名稱')),
                ('prediction_field_chinese', models.CharField(max_length=100, verbose_name='預測欄位中文名稱')),
                ('prediction_field_system', models.CharField(max_length=100, verbose_name='預測欄位系統名稱')),
                ('job_role_system_name', models.CharField(default='', help_text='爬蟲時用於篩選Job Role相關資訊的欄位名稱', max_length=100, verbose_name='Job Role系統對應名稱')),
                ('assignment_type', models.CharField(choices=[('all_open', '全部開放'), ('enterprise_only', '僅開放給企業'), ('individual_only', '僅開放給個人'), ('specific_assignment', '指定開放')], default='specific_assignment', max_length=20, verbose_name='指派類型')),
                ('created_at', models.DateTimeField(default=django.utils.timezone.now, verbose_name='建立時間')),
                ('updated_at', models.DateTimeField(auto_now=True, verbose_name='更新時間')),
                ('created_by', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to=settings.AUTH_USER_MODEL, verbose_name='建立者')),
            ],
            options={
                'verbose_name': '測驗項目',
                'verbose_name_plural': '測驗項目',
                'db_table': 'test_project',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='TestProjectCategory',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('name', models.CharField(max_length=200, verbose_name='分類完整名稱')),
                ('test_link', models.URLField(verbose_name='測驗連結')),
                ('advantage_analysis', models.TextField(verbose_name='優勢分析說明')),
                ('disadvantage_analysis', models.TextField(verbose_name='劣勢分析說明')),
                ('sort_order', models.IntegerField(default=0, verbose_name='排序')),
                ('created_at', models.DateTimeField(default=django.utils.timezone.now, verbose_name='建立時間')),
                ('updated_at', models.DateTimeField(auto_now=True, verbose_name='更新時間')),
                ('test_project', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='categories', to='core.testproject', verbose_name='測驗項目')),
            ],
            options={
                'verbose_name': '測驗項目分類',
                'verbose_name_plural': '測驗項目分類',
                'db_table': 'test_project_category',
                'ordering': ['sort_order', 'id'],
            },
        ),
        migrations.CreateModel(
            name='UserPointBalance',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('balance', models.IntegerField(default=0, verbose_name='點數餘額')),
                ('total_earned', models.IntegerField(default=0, verbose_name='累計獲得點數')),
                ('total_consumed', models.IntegerField(default=0, verbose_name='累計消費點數')),
                ('created_at', models.DateTimeField(auto_now_add=True, verbose_name='建立時間')),
                ('updated_at', models.DateTimeField(auto_now=True, verbose_name='更新時間')),
                ('user', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='point_balance', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': '用戶點數餘額',
                'verbose_name_plural': '用戶點數餘額',
                'db_table': 'user_point_balance',
            },
        ),
        migrations.CreateModel(
            name='TestTemplate',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('name', models.CharField(max_length=200, verbose_name='測驗名稱')),
                ('description', models.TextField(verbose_name='測驗描述')),
                ('duration_minutes', models.IntegerField(verbose_name='測驗時間（分鐘）')),
                ('question_count', models.IntegerField(verbose_name='題目數量')),
                ('point_cost', models.IntegerField(default=1, verbose_name='邀請費用（點數）')),
                ('is_active', models.BooleanField(default=True, verbose_name='是否啟用')),
                ('created_at', models.DateTimeField(auto_now_add=True, verbose_name='建立時間')),
                ('category', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='core.testcategory', verbose_name='測驗類別')),
            ],
            options={
                'verbose_name': '測驗範本',
                'verbose_name_plural': '測驗範本',
                'db_table': 'test_template',
            },
        ),
        migrations.CreateModel(
            name='TestProjectTrait',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('chinese_name', models.CharField(max_length=100, verbose_name='中文特質名稱')),
                ('system_name', models.CharField(max_length=100, verbose_name='系統對應名稱')),
                ('description', models.TextField(verbose_name='特質描述')),
                ('sort_order', models.IntegerField(default=0, verbose_name='排序')),
                ('created_at', models.DateTimeField(default=django.utils.timezone.now, verbose_name='建立時間')),
                ('updated_at', models.DateTimeField(auto_now=True, verbose_name='更新時間')),
                ('category', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='traits', to='core.testprojectcategory', verbose_name='測驗分類')),
            ],
            options={
                'verbose_name': '測驗項目特質',
                'verbose_name_plural': '測驗項目特質',
                'db_table': 'test_project_trait',
                'ordering': ['sort_order', 'id'],
            },
        ),
        migrations.CreateModel(
            name='TestProjectResult',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('raw_data', models.JSONField(default=dict, verbose_name='原始測驗數據')),
                ('processed_data', models.JSONField(default=dict, verbose_name='處理後數據')),
                ('score_value', models.FloatField(blank=True, null=True, verbose_name='評分值')),
                ('prediction_value', models.TextField(blank=True, verbose_name='預測值')),
                ('category_results', models.JSONField(default=dict, verbose_name='分類結果')),
                ('trait_results', models.JSONField(default=dict, verbose_name='特質結果')),
                ('crawled_at', models.DateTimeField(blank=True, null=True, verbose_name='爬蟲時間')),
                ('crawl_status', models.CharField(choices=[('pending', '待取得'), ('crawling', '取得中'), ('completed', '測驗完成'), ('failed', '取得失敗')], default='pending', max_length=20, verbose_name='受測狀態')),
                ('report_generated', models.BooleanField(default=False, verbose_name='報告已生成')),
                ('report_path', models.CharField(blank=True, max_length=500, verbose_name='報告路徑')),
                ('created_at', models.DateTimeField(default=django.utils.timezone.now, verbose_name='建立時間')),
                ('updated_at', models.DateTimeField(auto_now=True, verbose_name='更新時間')),
                ('test_invitation', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='testprojectresult', to='core.testinvitation', verbose_name='測驗邀請')),
                ('test_project', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='core.testproject', verbose_name='測驗項目')),
            ],
            options={
                'verbose_name': '測驗項目結果',
                'verbose_name_plural': '測驗項目結果',
                'db_table': 'test_project_result',
            },
        ),
        migrations.CreateModel(
            name='TestInvitee',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('name', models.CharField(max_length=50, verbose_name='姓名')),
                ('email', models.EmailField(max_length=254, verbose_name='電子郵件')),
                ('phone', models.CharField(blank=True, max_length=20, verbose_name='聯絡電話')),
                ('company', models.CharField(blank=True, max_length=100, verbose_name='所屬公司')),
                ('position', models.CharField(blank=True, max_length=50, verbose_name='職位')),
                ('notes', models.TextField(blank=True, verbose_name='備註')),
                ('invited_count', models.IntegerField(default=0, verbose_name='受邀次數')),
                ('completed_count', models.IntegerField(default=0, verbose_name='完成次數')),
                ('last_test_date', models.DateTimeField(blank=True, null=True, verbose_name='最後測驗時間')),
                ('created_at', models.DateTimeField(auto_now_add=True, verbose_name='建立時間')),
                ('updated_at', models.DateTimeField(auto_now=True, verbose_name='更新時間')),
                ('enterprise', models.ForeignKey(limit_choices_to={'user_type': 'enterprise'}, on_delete=django.db.models.deletion.CASCADE, related_name='test_invitees', to=settings.AUTH_USER_MODEL, verbose_name='邀請企業')),
            ],
            options={
                'verbose_name': '受測人員',
                'verbose_name_plural': '受測人員',
                'db_table': 'test_invitee',
                'unique_together': {('enterprise', 'email')},
            },
        ),
        migrations.AddField(
            model_name='testinvitation',
            name='invitee',
            field=models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='core.testinvitee', verbose_name='受測人員'),
        ),
        migrations.AddField(
            model_name='testinvitation',
            name='test_project',
            field=models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, to='core.testproject', verbose_name='測驗項目'),
        ),
        migrations.AddField(
            model_name='testinvitation',
            name='test_template',
            field=models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, to='core.testtemplate', verbose_name='測驗範本'),
        ),
        migrations.CreateModel(
            name='PointTransaction',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('transaction_type', models.CharField(choices=[('purchase', '購買'), ('consumption', '消費'), ('refund', '退款'), ('admin_adjust', '管理員調整'), ('gift', '贈送'), ('registration_bonus', '註冊獎勵'), ('enterprise_bonus', '企業獎勵')], max_length=20, verbose_name='交易類型')),
                ('amount', models.IntegerField(verbose_name='點數數量')),
                ('balance_before', models.IntegerField(verbose_name='交易前餘額')),
                ('balance_after', models.IntegerField(verbose_name='交易後餘額')),
                ('description', models.TextField(verbose_name='交易描述')),
                ('reference_id', models.CharField(blank=True, max_length=100, verbose_name='關聯ID')),
                ('status', models.CharField(choices=[('pending', '處理中'), ('completed', '已完成'), ('failed', '失敗'), ('cancelled', '已取消')], default='completed', max_length=20, verbose_name='狀態')),
                ('metadata', models.JSONField(blank=True, default=dict, verbose_name='額外資訊')),
                ('created_at', models.DateTimeField(auto_now_add=True, verbose_name='交易時間')),
                ('user', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='point_transactions', to=settings.AUTH_USER_MODEL, verbose_name='用戶')),
            ],
            options={
                'verbose_name': '點數交易記錄',
                'verbose_name_plural': '點數交易記錄',
                'db_table': 'point_transaction',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='PointOrder',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('order_number', models.CharField(max_length=50, unique=True, verbose_name='訂單號')),
                ('points', models.IntegerField(verbose_name='購買點數')),
                ('bonus_points', models.IntegerField(default=0, verbose_name='贈送點數')),
                ('amount', models.DecimalField(decimal_places=2, max_digits=10, verbose_name='訂單金額')),
                ('status', models.CharField(choices=[('pending', '待付款'), ('paid', '已付款'), ('completed', '已完成'), ('failed', '失敗'), ('cancelled', '已取消'), ('refunded', '已退款')], default='pending', max_length=20, verbose_name='訂單狀態')),
                ('payment_method', models.CharField(blank=True, max_length=50, verbose_name='付款方式')),
                ('payment_reference', models.CharField(blank=True, max_length=100, verbose_name='付款參考號')),
                ('notes', models.TextField(blank=True, verbose_name='備註')),
                ('created_at', models.DateTimeField(auto_now_add=True, verbose_name='建立時間')),
                ('paid_at', models.DateTimeField(blank=True, null=True, verbose_name='付款時間')),
                ('completed_at', models.DateTimeField(blank=True, null=True, verbose_name='完成時間')),
                ('package', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, to='core.pointpackage', verbose_name='點數套餐')),
                ('user', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='point_orders', to=settings.AUTH_USER_MODEL, verbose_name='用戶')),
            ],
            options={
                'verbose_name': '點數購買訂單',
                'verbose_name_plural': '點數購買訂單',
                'db_table': 'point_order',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='Notification',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('title', models.CharField(max_length=200, verbose_name='標題')),
                ('message', models.TextField(verbose_name='訊息內容')),
                ('notification_type', models.CharField(choices=[('system', '系統通知'), ('enterprise_approval', '企業審核'), ('point_transaction', '點數交易'), ('test_invitation', '測驗邀請'), ('test_result', '測驗結果'), ('account', '帳號相關')], default='system', max_length=20, verbose_name='通知類型')),
                ('priority', models.CharField(choices=[('low', '低'), ('normal', '普通'), ('high', '高'), ('urgent', '緊急')], default='normal', max_length=10, verbose_name='優先級')),
                ('object_id', models.PositiveIntegerField(blank=True, null=True)),
                ('is_read', models.BooleanField(default=False, verbose_name='已讀')),
                ('read_at', models.DateTimeField(blank=True, null=True, verbose_name='閱讀時間')),
                ('created_at', models.DateTimeField(default=django.utils.timezone.now, verbose_name='建立時間')),
                ('expires_at', models.DateTimeField(blank=True, null=True, verbose_name='過期時間')),
                ('metadata', models.JSONField(blank=True, default=dict, verbose_name='額外資料')),
                ('content_type', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, to='contenttypes.contenttype')),
                ('recipient', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='notifications', to=settings.AUTH_USER_MODEL, verbose_name='接收者')),
            ],
            options={
                'verbose_name': '通知',
                'verbose_name_plural': '通知',
                'db_table': 'notification',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='InvitationTemplate',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('name', models.CharField(max_length=100, verbose_name='模板名稱')),
                ('template_type', models.CharField(choices=[('default', '預設模板'), ('formal', '正式模板'), ('casual', '輕鬆模板'), ('urgent', '緊急模板'), ('custom', '自定義模板')], default='custom', max_length=20, verbose_name='模板類型')),
                ('subject_template', models.CharField(help_text='可使用變數：{invitee_name}, {company_name}, {test_name}, {enterprise_name}', max_length=200, verbose_name='郵件主旨模板')),
                ('message_template', models.TextField(help_text='可使用變數：{invitee_name}, {company_name}, {test_name}, {enterprise_name}, {test_url}, {expires_date}', verbose_name='郵件內容模板')),
                ('is_default', models.BooleanField(default=False, verbose_name='是否為預設模板')),
                ('is_active', models.BooleanField(default=True, verbose_name='是否啟用')),
                ('usage_count', models.IntegerField(default=0, verbose_name='使用次數')),
                ('last_used_at', models.DateTimeField(blank=True, null=True, verbose_name='最後使用時間')),
                ('created_at', models.DateTimeField(default=django.utils.timezone.now, verbose_name='建立時間')),
                ('updated_at', models.DateTimeField(auto_now=True, verbose_name='更新時間')),
                ('enterprise', models.ForeignKey(limit_choices_to={'user_type': 'enterprise'}, on_delete=django.db.models.deletion.CASCADE, related_name='invitation_templates', to=settings.AUTH_USER_MODEL, verbose_name='企業用戶')),
            ],
            options={
                'verbose_name': '邀請訊息模板',
                'verbose_name_plural': '邀請訊息模板',
                'db_table': 'invitation_template',
                'ordering': ['-is_default', '-last_used_at', '-created_at'],
            },
        ),
        migrations.CreateModel(
            name='IndividualProfile',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('real_name', models.CharField(max_length=50, verbose_name='真實姓名')),
                ('id_number', models.CharField(blank=True, max_length=20, null=True, verbose_name='身分證字號')),
                ('birth_date', models.DateField(blank=True, null=True, verbose_name='生日')),
                ('user', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='individual_profile', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': '個人資料',
                'verbose_name_plural': '個人資料',
                'db_table': 'individual_profile',
            },
        ),
        migrations.CreateModel(
            name='EnterpriseProfile',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('company_name', models.CharField(max_length=100, verbose_name='公司名稱')),
                ('tax_id', models.CharField(db_index=True, max_length=8, unique=True, verbose_name='統一編號')),
                ('contact_person', models.CharField(max_length=50, verbose_name='聯絡人姓名')),
                ('contact_phone', models.CharField(max_length=20, verbose_name='聯絡電話')),
                ('address', models.TextField(blank=True, null=True, verbose_name='公司地址')),
                ('verification_status', models.CharField(choices=[('pending', '待審核'), ('approved', '已核准'), ('rejected', '已拒絕')], default='pending', max_length=20, verbose_name='驗證狀態')),
                ('verified_at', models.DateTimeField(blank=True, null=True, verbose_name='驗證時間')),
                ('user', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='enterprise_profile', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': '企業資料',
                'verbose_name_plural': '企業資料',
                'db_table': 'enterprise_profile',
            },
        ),
        migrations.CreateModel(
            name='TestProjectIndividualAssignment',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('is_active', models.BooleanField(default=True, verbose_name='是否有效')),
                ('assigned_at', models.DateTimeField(default=django.utils.timezone.now, verbose_name='指派時間')),
                ('assigned_by', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='assigned_individual_projects', to=settings.AUTH_USER_MODEL, verbose_name='指派者')),
                ('individual_user', models.ForeignKey(limit_choices_to={'user_type': 'individual'}, on_delete=django.db.models.deletion.CASCADE, to=settings.AUTH_USER_MODEL, verbose_name='個人用戶')),
                ('test_project', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='individual_assignments', to='core.testproject', verbose_name='測驗項目')),
            ],
            options={
                'verbose_name': '測驗項目個人指派',
                'verbose_name_plural': '測驗項目個人指派',
                'db_table': 'test_project_individual_assignment',
                'unique_together': {('test_project', 'individual_user')},
            },
        ),
        migrations.CreateModel(
            name='TestProjectAssignment',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('is_active', models.BooleanField(default=True, verbose_name='是否有效')),
                ('assigned_at', models.DateTimeField(default=django.utils.timezone.now, verbose_name='指派時間')),
                ('assigned_by', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='assigned_test_projects', to=settings.AUTH_USER_MODEL, verbose_name='指派者')),
                ('enterprise_user', models.ForeignKey(limit_choices_to={'user_type': 'enterprise'}, on_delete=django.db.models.deletion.CASCADE, to=settings.AUTH_USER_MODEL, verbose_name='企業用戶')),
                ('test_project', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='assignments', to='core.testproject', verbose_name='測驗項目')),
            ],
            options={
                'verbose_name': '測驗項目企業指派',
                'verbose_name_plural': '測驗項目企業指派',
                'db_table': 'test_project_assignment',
                'unique_together': {('test_project', 'enterprise_user')},
            },
        ),
        migrations.AddIndex(
            model_name='testinvitation',
            index=models.Index(fields=['enterprise', 'status'], name='test_invita_enterpr_d1a31e_idx'),
        ),
        migrations.AddIndex(
            model_name='testinvitation',
            index=models.Index(fields=['invitee'], name='test_invita_invitee_cf6df8_idx'),
        ),
        migrations.AddIndex(
            model_name='testinvitation',
            index=models.Index(fields=['invitation_code'], name='test_invita_invitat_d3f257_idx'),
        ),
        migrations.AddIndex(
            model_name='testinvitation',
            index=models.Index(fields=['test_project'], name='test_invita_test_pr_80593f_idx'),
        ),
        migrations.AddIndex(
            model_name='pointtransaction',
            index=models.Index(fields=['user', 'transaction_type'], name='point_trans_user_id_88226f_idx'),
        ),
        migrations.AddIndex(
            model_name='pointtransaction',
            index=models.Index(fields=['created_at'], name='point_trans_created_2e5b77_idx'),
        ),
        migrations.AddIndex(
            model_name='pointtransaction',
            index=models.Index(fields=['reference_id'], name='point_trans_referen_97367e_idx'),
        ),
        migrations.AddIndex(
            model_name='pointorder',
            index=models.Index(fields=['user', 'status'], name='point_order_user_id_6625e6_idx'),
        ),
        migrations.AddIndex(
            model_name='pointorder',
            index=models.Index(fields=['order_number'], name='point_order_order_n_4ac5ca_idx'),
        ),
        migrations.AddIndex(
            model_name='pointorder',
            index=models.Index(fields=['created_at'], name='point_order_created_3571a4_idx'),
        ),
        migrations.AddIndex(
            model_name='notification',
            index=models.Index(fields=['recipient', 'is_read'], name='notificatio_recipie_201701_idx'),
        ),
        migrations.AddIndex(
            model_name='notification',
            index=models.Index(fields=['created_at'], name='notificatio_created_db7ad3_idx'),
        ),
        migrations.AddIndex(
            model_name='notification',
            index=models.Index(fields=['notification_type'], name='notificatio_notific_f8d066_idx'),
        ),
        migrations.AlterUniqueTogether(
            name='invitationtemplate',
            unique_together={('enterprise', 'name')},
        ),
    ]
