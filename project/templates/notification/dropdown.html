{% if notifications %}
    <div class="dropdown-header d-flex justify-content-between align-items-center">
        <span>通知 ({{ unread_count }} 未讀)</span>
        {% if unread_count > 0 %}
        <button class="btn btn-sm btn-link text-muted mark-all-read" data-url="{% url 'mark_all_notifications_read' %}">
            全部已讀
        </button>
        {% endif %}
    </div>
    
    {% for notification in notifications %}
    <div class="dropdown-item {% if not notification.is_read %}bg-light border-start border-primary border-3{% endif %} position-relative">
        <div class="d-flex w-100 justify-content-between align-items-start">
            <div class="flex-grow-1">
                <h6 class="mb-1 d-flex align-items-center">
                    <i class="{{ notification.icon }} me-2 {% if notification.priority == 'high' %}text-warning{% elif notification.priority == 'urgent' %}text-danger{% else %}text-primary{% endif %}"></i>
                    {{ notification.title }}
                </h6>
                <p class="mb-1 small text-muted">{{ notification.message|truncatechars:80 }}</p>
                <small class="text-muted">{{ notification.time_since }}前</small>
            </div>
            {% if not notification.is_read %}
            <button class="btn btn-sm btn-outline-primary mark-read ms-2" 
                    data-notification-id="{{ notification.id }}">
                <i class="bi bi-check"></i>
            </button>
            {% endif %}
        </div>
    </div>
    {% endfor %}
    
    <div class="dropdown-divider"></div>
    <div class="dropdown-footer text-center">
        <a href="{% url 'notification_list' %}" class="btn btn-sm btn-link">查看全部通知</a>
    </div>
{% else %}
    <div class="p-4 text-center text-muted">
        <i class="bi bi-bell-slash fs-1 mb-2 d-block"></i>
        <p class="mb-0">目前沒有通知</p>
    </div>
{% endif %}